FROM alpine
RUN apk update && \
    apk add python3 py3-flask curl
RUN mkdir /data
COPY master.py /master.py
COPY config.ini /data/config.ini
RUN python3 /master.py & proc=$! && sleep 3 && curl -i http://localhost:5000/api/init && kill -s SIGINT $proc
VOLUME /data
CMD python3 /master.py
